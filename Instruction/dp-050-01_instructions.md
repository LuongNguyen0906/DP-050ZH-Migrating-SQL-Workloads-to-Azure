---
lab:
    title: '实验室 1 - Azure 体系结构注意事项'
    module: '模块 1：介绍 Data Platform Modernization'
---

# DP-050 - 将 SQL 工作负荷迁移到 Azure
# 实验室 1 - Azure 体系结构注意事项

**预计用时**：50 分钟

**先决条件**：没有用于执行此实验室的先决条件步骤。

**实验室文件**：此实验室的文件位于 _Allfiles\Labfiles\Starter\DP-150.1_ 文件夹中。

## 实验室概述

学生将使用本模块中获得的信息来展示对 Data Platform Modernization 的理解，以及组织为何及如何在高层次上实施现代化项目。他们将演示如何确定迁移到 Azure 的成本。他们还将收集与正在处理的环境有关的信息。学生将最终确定应该用于给定场景的 Data Platform Modernization 策略。

## 实验室目标
  
完成本实验室后，你将能够：

1. 了解 Data Platform Modernization
2. 了解迁移的阶段
3. 数据迁移技术

## 方案
  
你最近被聘为 AdventureWorks 的高级数据工程师，并正在与顾问和架构师合作，启动满足组织技术和业务要求的数据平台现代化项目。你将演示一个示例，说明他们如何计算迁移到 Azure 的总拥有成本。然后，你要求初级数据工程师收集有关将迁移到 Azure 的 SQL Server 的信息。然后，对于给定的方案，你将为其提出最佳的 Azure 数据平台迁移技术。

在本实验室结束时，你将可以：

1. 了解 Data Platform Modernization
2. 了解迁移的阶段
3. 数据迁移技术

## 练习 1：了解 Data Platform Modernization

在本实验室中，你将演示如何计算数据库的成本

预计用时：15 分钟

本次练习的主要任务如下：

1. 打开 Microsoft 总拥有成本 (TCO) 计算器
1. 定义基于服务器的工作负荷
1. 添加一些存储
1. 添加一些网络
1. 调整货币
1. 调整电力成本
1. 调整其他假设
1. 比较本地和 Azure 成本

### 任务 1：打开总拥有成本 (TCO) 计算器

1. 打开你的浏览器
1. 导航到 [Azure TCO 计算器](https://azure.microsoft.com/zh-cn/pricing/tco/calculator/)
1. 从“定义工作负荷”部分确保“**服务器**”部分没有工作负荷

### 任务 2：输入数据库工作负荷

1. 在“**数据库**”工作负荷部分，单击“**+添加数据库**”超链接。
1. 将工作负荷命名为“**Accounting**”
1. 在“**来源**”下输入以下内容
   - 数据库“**Microsoft SQL Server**”
   - 许可证“**Enterprise**”
   - 环境“**物理服务器**”
   - 操作系统“**Windows**”
   - 服务器“**1**”
   - 每个服务器的进程“**1**”
   - 每个进程的核心“**4**”
   - RAM (GB)“**64**”
   - 优化方式“**CPU**”
   - SQL Server 2008/2008R2“**True**”
1. 在“**目标**”下输入以下内容
   - 服务“**SQL Server VM**”
   - 磁盘类型“**SSD**”

    > 这是针对 Azure 中的生产服务器的建议
   - IOPS“**5000**”
   - SQL Server 存储“**32 GB**”
   - SQL Server 备份“**32 GB**”

### 任务 3：输入存储工作负荷

1. 在“**存储**”工作负荷部分
2. 将工作负荷命名为“**Accounting Local Disks**”
   - 存储类型“**本地磁盘/SAN**”
   - 磁盘类型“**HDD**”
   - 容量“**3TB**”
   - 容量“**1TB**”
   - 存档“**0TB**”

### 任务 4：输入网络工作负荷

1. 在“**网络**”工作负荷部分
   - 出站带宽 **保留默认值**


1. 向下滚动网页，然后单击标记为“**下一个**”的蓝色按钮

### 任务 5：调整货币

1. 在“**调整假设**”部分确保货币设置为你的本国货币

### 任务 6：软件保障

1. 在“**软件保障范围（提供 Azure 混合权益）**”部分
   - Windows Server 软件保障范围 **True**
   - SQL Server 软件保障范围 **True**
   - 单击链接并研究内容

### 任务 7：异地冗余存储 (GRS)

1. 在“**异地冗余存储 (GRS)**”部分
   - GRS 将你的数据复制到距离主要区域数百英里的次要区域。**设为默认值**
   - 单击链接并研究内容

### 任务 8：虚拟机成本

1. 在“**虚拟机成本**”部分
   - 启用此选项以使计算器不推荐 B 系列虚拟机 **保留默认值**
   - 单击链接并研究内容

### 任务 9：电力成本

1. 在“**异地冗余存储 (GRS)**”部分
   - 每千瓦时价格“**如果已知，请输入实际值**”

     > **注意** 2018 年的全球电价可以在这里找到 [2018 年全球电价](https://www.statista.com/statistics/263492/electricity-prices-in-selected-countries/)。这些价格以美元 ($) 为单位，需要转换为你的本国货币

### 任务 10：存储成本

1. 在“**存储成本**”部分
    - 本地磁盘/SAN-SSD 的存储采购成本/GB **保留默认值**
    - 本地磁盘/SAN-HDD 的存储采购成本/GB **保留默认值**
    - NAS/文件存储的存储采购成本/GB **保留默认值**
    - Blob 存储的存储采购成本/GB **保留默认值**
    - 年度企业存储软件支持成本 **保留默认值**
    - 每个磁带驱动器的成本 **保留默认值**

### 任务 11：IT 人工成本

1. 在“**IT 人工成本**”部分
    - 可由全职管理员管理的物理服务器数 **保留默认值**
    - 可由全职管理员管理的虚拟机数 **保留默认值**
    - IT 管理员的小时工资率 **保留默认值**

### 任务 12：其他假设

1. 在“**其他假设**”部分
   - 展开每个部分并查看相关成本

### 任务 13：报告（1 年）

1. 单击“**下一步**”
1. 请注意，在顶部（在“查看报告”下），时间范围默认为 1 年
1. 向下滚动到报告并研究预估的本地和 Azure 成本明细
1. 本地的大部分支出用在哪里？
1. 研究最大的成本节省在哪里
1. 依次展开每个部分并研究成本明细

### 任务 14：报告（3 年）

1. 滚动到页面顶部
1. 在“查看报告”下
   - 时间范围 **3 年**
1. 向下滚动到报告并研究预估的本地和 Azure 成本明细
1. 5 年的总支出是多少？
1. 本地的大部分支出用在哪里？
1. 依次展开每个部分并研究成本明细

> **结果**：完成本练习后，你已使用 Azure TCO 计算器识别 Adatum Corporation 的 Accounting 服务器及其关联数据库的本地和 Azure 部署之间的成本差异

## 练习 2：了解迁移的阶段
  
在本练习中，你将对你正在使用的服务器进行探索，以了解计算机的规格。

预计用时：15 分钟
  
本次练习的主要任务如下：

1. 确定正在使用的内存量 
1. 确定系统中正在使用的 CPU
1. 确定服务器上的磁盘配置

### 任务 1：确定服务器上正在使用的内存量。

1. 选择你所选的任何方法以确定服务器上正在使用的内存量。 

> **提示**：使用系统信息工具捕获此信息

1. 在记事本上记录此值。

### 任务 2：确定服务器上正在使用的 CPU 的数量。

1. 选择你所选的任何方法以确定服务器上正在使用的内存量。

1. 在记事本上记录此值。

### 任务 3：确定服务器上正在使用的磁盘配置。

1. 选择你所选的任何方法以确定服务器上正在使用的内存量。

1. 在记事本上记录此值。

1. 将记事本以 ServerSpecs.txt 为名称保存到 _Allfiles\Labfiles\Starter\DP-150.1_ 文件夹中

> **结果**：完成本练习后，你已收集有关服务器硬件规格的信息。

## 练习 3：数据迁移技术

在本练习中，你将选择一种数据平台技术来帮助客户从本地 SQL Server 迁移到 Azure 

预计用时：15 分钟 

本次练习的主要任务如下：

1. 确定方案 A 中促进迁移所需的数据库技术。
1. 确定方案 B 中促进迁移所需的数据库技术。

### 任务 1：确定方案 A 中促进迁移所需的数据库技术。

1. 阅读以下方案

    客户的应用程序使用当前驻留在 Microsoft SQL Server 2008 本地版本中的许多数据库。数据库总占用情况较大，以每年数个 TB 的速率快速增长。数据库所在的现有 SAN 存储几乎都达到满负荷，扩展成本高，并且其使用寿命接近到期。该应用程序对公司至关重要，事务率适中，任何故障时间都会对业务产生重大影响。可以使用小型维护窗口进行更改，以最大限度地提高应用程序的可用性。高增长率已经让 DBA 和 sysadmin 花费越来越多的时间来保持一切正常运转

1. 在此方案中，哪种数据库平台技术合适？

### 任务 2：确定方案 B 中促进迁移所需的数据库技术。

1. 阅读以下方案

    此示例中的客户具有一个 SQL Server，用于存储满足部门需求的数据库。承载此数据库的服务器是四核服务器，具有 16GB 内存，用作电子表格和 Access 窗体的简单数据访问的后端。共有 6 个数据库，总共需要 350 MB。此服务器的并发连接上限为 12 个。

1. 在此方案中，哪种数据库平台技术合适？

> **结果**：完成本练习后，你将确定可以作为基础的相应数据库迁移技术。

## 实验室评价

大约 45 分钟后，讲师将结束此实验室。班级将讨论每个组的检测结果。

